<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.jhj.teamproject.user.mappers.UserMapper">

<!--    <insert id="insertUser" useGeneratedKeys="true" keyColumn="id" keyProperty="id" >-->
<!--        insert into `leave`.`users` (email, password, name, role, joined_at)-->
<!--        values(#{user.email},#{user.password},#{user.name},#{user.role},#{user.joinedAt});-->
<!--    </insert>-->


    <insert id="insertAnnual"
    useGeneratedKeys="true"
    keyColumn="id"
    keyProperty="id">
        insert into `leave`.`annual_leaves`
        (user_id, total_days, used_days)
        values (#{annual.userId},#{annual.totalDays},#{annual.usedDays});
    </insert>


<!--    <update id="update">-->
<!--        update `leave`.`users`-->
<!--        set `email`=#{user.email},-->
<!--            `password`= #{user.password},-->
<!--            `name`=#{user.name},-->
<!--            `role`=#{user.name},-->
<!--            `modified_at`=#{user.modifiedAt}-->
<!--        where `id` = ${user.id}-->
<!--        limit 1;-->
<!--    </update>-->
    <select id="selectById" resultType="com.jhj.teamproject.user.entities.UserEntity">
        select `id`                as `id`,
               `email`             as `email`,
               `password`          as `password`,
               `name`              as `name`,
               `is_admin`          as `isAdmin`,
               `is_delete`         as `isDelete`,
               `created_at`        as `createdAt`,
               `modified_at`       as `modifiedAt`,
               `contact_mvno_code` as `contactMvno`,
               `contact_first`     as `contactFirst`,
               `contact_second`    as `contactSecond`,
               `contact_third`     as `contactThird`,
               `address_postal`    as `addressPostal`,
               `address_primary`   as `addressPrimary`,
               `address_secondary` as `addressSecondary`
        from `leave`.`users`
        where `id` = #{id}
        limit 1;
    </select>
    <select id="selectCountByEmail" resultType="java.lang.Integer">
        select count(0)
        from `leave`.`users`
        where `email` = #{user.email};
    </select>
</mapper>